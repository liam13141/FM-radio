<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>FM Radio Player ‚Äî Chrome Diagnostics</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0e0f12;
  --panel: #17191e;
  --border: #232a33;
  --txt: #e9eef3;
  --accent: #00c6ff;
  --green: #47d18c;
  --red: #ff5577;
  --amber: #ffcb4b;
}
body {
  font-family: "Poppins", system-ui, sans-serif;
  background: var(--bg);
  color: var(--txt);
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
  min-height: 100vh;
}
h1 { color: var(--accent); font-size: 1.6rem; }
section {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 16px;
}
h2 {
  font-size: 1.1rem;
  color: var(--accent);
  margin-bottom: 8px;
}
button {
  background: var(--accent);
  border: none;
  color: #041017;
  font-weight: 600;
  border-radius: 10px;
  padding: 8px 14px;
  cursor: pointer;
}
.log {
  background: #10141a;
  border: 1px solid var(--border);
  border-radius: 8px;
  font-family: ui-monospace, Consolas, monospace;
  padding: 10px;
  max-height: 250px;
  overflow-y: auto;
  white-space: pre-wrap;
}
.ok { color: var(--green); }
.bad { color: var(--red); }
.warn { color: var(--amber); }
</style>
</head>
<body>
<h1>üîç Chrome System & Access Diagnostics</h1>
<p>Perform deep browser, network, permission, and API tests. Best viewed in Google Chrome.</p>
<button id="runBtn">‚ñ∂ Run Full Diagnostics</button>

<section><h2>üñ•Ô∏è System Info</h2><div class="log" id="sysLog"></div></section>
<section><h2>üåê Network & IP</h2><div class="log" id="netLog"></div></section>
<section><h2>üîí Permissions & Access</h2><div class="log" id="permLog"></div></section>
<section><h2>üíæ Storage & Cookies</h2><div class="log" id="storLog"></div></section>
<section><h2>üß† Browser Environment</h2><div class="log" id="envLog"></div></section>
<section><h2>üì° API & Connectivity Tests</h2><div class="log" id="apiLog"></div></section>

<script>
const logs = {
  sys: document.getElementById("sysLog"),
  net: document.getElementById("netLog"),
  perm: document.getElementById("permLog"),
  stor: document.getElementById("storLog"),
  env: document.getElementById("envLog"),
  api: document.getElementById("apiLog")
};
const log = (panel, msg, cls="")=>{
  const line=document.createElement("div");
  if(cls) line.className=cls;
  line.textContent=`[${new Date().toLocaleTimeString()}] ${msg}`;
  logs[panel].appendChild(line);
  logs[panel].scrollTop=logs[panel].scrollHeight;
};

async function runDiagnostics(){
  Object.values(logs).forEach(l=>l.textContent="");
  log("sys","Running system diagnostics...","warn");

  // ---- System Info ----
  log("sys",`User Agent: ${navigator.userAgent}`);
  log("sys",`Platform: ${navigator.platform}`);
  log("sys",`Browser: ${navigator.userAgentData?.brands?.map(b=>b.brand+':'+b.version).join(', ') || 'N/A'}`);
  log("sys",`Language: ${navigator.language}`);
  log("sys",`Screen: ${screen.width}x${screen.height} @${window.devicePixelRatio}x`);
  log("sys",`Hardware Concurrency: ${navigator.hardwareConcurrency || 'Unknown'}`);
  if(navigator.gpu) log("sys",`GPU: ${JSON.stringify(navigator.gpu)}`);

  // Battery
  if(navigator.getBattery){
    try{
      const b=await navigator.getBattery();
      log("sys",`Battery: ${Math.round(b.level*100)}% ${b.charging?"(Charging)":"(Discharging)"}`);
    }catch(e){ log("sys","Battery info unavailable","bad"); }
  }

  // Memory
  if(performance.memory){
    log("sys",`JS Heap: ${(performance.memory.usedJSHeapSize/1048576).toFixed(1)}MB / ${(performance.memory.jsHeapSizeLimit/1048576).toFixed(1)}MB`);
  }

  // ---- Network ----
  const conn = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
  if(conn){
    log("net",`Connection Type: ${conn.effectiveType}`);
    log("net",`Downlink: ${conn.downlink} Mb/s`);
  }
  log("net",`Online: ${navigator.onLine ? "‚úÖ Online" : "‚ùå Offline"}`);

  try{
    const res=await fetch("https://api.ipify.org?format=json");
    const ip=await res.json();
    log("net",`Public IP: ${ip.ip}`,"ok");
  }catch{ log("net","Failed to retrieve public IP","bad"); }

  // ---- Permissions ----
  const perms = ["geolocation","notifications","camera","microphone","clipboard-read"];
  for(const perm of perms){
    try{
      const p = await navigator.permissions.query({name:perm});
      log("perm",`${perm}: ${p.state}`,(p.state==="granted"?"ok":p.state==="prompt"?"warn":"bad"));
    }catch{ log("perm",`${perm}: unsupported`,"bad"); }
  }

  // ---- Storage ----
  try{
    localStorage.setItem("fm_test","1"); localStorage.removeItem("fm_test");
    log("stor","LocalStorage: ‚úÖ accessible","ok");
  }catch{ log("stor","LocalStorage: ‚ùå blocked","bad"); }
  try{
    await navigator.storage.estimate().then(s=>{
      log("stor",`Quota: ${(s.quota/1e6).toFixed(1)}MB, Used: ${(s.usage/1e6).toFixed(1)}MB`);
    });
  }catch{ log("stor","Could not get storage info","bad"); }

  try{
    document.cookie="fm_cookie=1";
    log("stor",`Cookies: ${document.cookie.includes("fm_cookie")?"‚úÖ enabled":"‚ùå disabled"}`,
        document.cookie.includes("fm_cookie")?"ok":"bad");
  }catch{ log("stor","Cookies: ‚ùå blocked","bad"); }

  // ---- Environment ----
  log("env",`Timezone: ${Intl.DateTimeFormat().resolvedOptions().timeZone}`);
  log("env",`Device Memory: ${navigator.deviceMemory || "Unknown"}GB`);
  log("env",`Do Not Track: ${navigator.doNotTrack}`);
  log("env",`Service Worker: ${"serviceWorker" in navigator ? "Supported":"Not supported"}`);
  log("env",`Clipboard API: ${"clipboard" in navigator ? "Supported":"Not supported"}`);
  log("env",`Media Devices: ${(await navigator.mediaDevices.enumerateDevices()).length} devices`);

  // ---- API / Connectivity Tests ----
  const tests = [
    ["https://fmradio.media/status","FM Radio API"],
    ["https://jsonplaceholder.typicode.com/posts/1","JSONPlaceholder"],
    ["https://api.github.com","GitHub API"],
  ];
  for(const [url,name] of tests){
    const t0=performance.now();
    try{
      const res=await fetch(url);
      const ms=Math.round(performance.now()-t0);
      log("api",`${name}: ${res.status} (${ms}ms)`,"ok");
    }catch(e){
      log("api",`${name}: failed (${e.message})`,"bad");
    }
  }

  log("api","Diagnostics complete.","warn");
}

document.getElementById("runBtn").addEventListener("click",runDiagnostics);
</script>
</body>
</html>
